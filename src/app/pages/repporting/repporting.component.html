<div class="main">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">


  <app-nav-bar></app-nav-bar>

<div class="content">

  <div>
    <button class="burger" (click)="open()">☰</button>
  </div>

  <div  class="mt-3 mx-20 h1">
    REPPORTING
  </div>

  


  <div class="mt-3 p-4 m-20 br-2 white center_block">

    <div class="mt-3 p-4 m-20 br-2 white center_block">
      <div class="p-4 flex space">
        <button mat-stroked-button color="primary" onClick="window.location.reload();">Mise a jour</button>
        <!-- <button mat-stroked-button color="primary" (click)="exportToExcel()" >Exporter</button> -->
        <!-- <div class="flex user_info"> -->
  
          <!-- <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            <button class="btn btn-outline-primary" type="button">Button</button>
            <button class="btn btn-outline-secondary" type="button">Button</button>
          </div> -->
  
        <!-- </div> -->
      </div>
    </div>

    <div class="main-searchbar" debounce="500">
      <mat-form-field>
        <!-- <input matInput (keyup)="applyFilter($event)" placeholder="Filter" animated> -->
      </mat-form-field>
    </div>
    
    <div class="accordion" id="accordionExample">
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingOne">
          <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
            Accordion Item #1
          </button>
        </h2>
        <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
          <div class="accordion-body">
            <strong>This is the first item's accordion body.</strong> It is shown by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingTwo">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
            Accordion Item #2
          </button>
        </h2>
        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
          <div class="accordion-body">
            <strong>This is the second item's accordion body.</strong> It is hidden by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingThree">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
            Accordion Item #3
          </button>
        </h2>
        <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
          <div class="accordion-body">
            <strong>This is the third item's accordion body.</strong> It is hidden by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.
          </div>
        </div>
      </div>
    </div>

    <table>
      <button mat-stroked-button color="primary" (click)="exportToExcelBureauInfo()" >Exporter</button>
      <caption>Bureau de vote repporting</caption>
      <tr>
          <th scope="col">% BUREAU OUVERT A L'HEURE</th>
          <th scope="col">% BUREAU AVEC TOUS LES AGENTS PRÉSENTE</th>
          <th scope="col">% BUREAU DISPOSANT DE TOUT LE MATERIEL</th>
      </tr>
      <tr>
          <!-- <th scope="row">TR-7</th> -->
          <td>{{tauxOuvertHeure != undefined || tauxOuvertHeure != null ? tauxOuvertHeure +"%" : 'PAS ENCORE DE RAPPORTS'}}</td>
          <td>{{bureauAgentPresent != null ? bureauAgentPresent+"%" : 'PAS ENCORE DE RAPPORTS'}}</td>
          <td>{{disponnibiliteMateriel != null ? disponnibiliteMateriel+"%" : 'PAS ENCORE DE RAPPORTS'}}</td>
      </tr>
    </table>

    <table>
      <button mat-stroked-button color="primary" (click)="exportToExcelTaux()" >Exporter</button>
      <caption>Reporting sur les Bureaux de vote sur les TAUX DE PARTICIPATION</caption>
      <tr>
          <th scope="col">TAUX DE PARTICIPATION A MIDI</th>
          <th scope="col">TAUX DE PARTICIPATION FINAL</th>
          <!-- <th scope="col">% BUREAU DISPOSANT DE TOUT LE MATERIEL</th> -->
      </tr>
      <tr>
          <!-- <th scope="row">TR-7</th> -->
          <!-- <td>7</td> -->
          <td>7</td>
          <td>4,569</td>
      </tr>
    </table>

    <table>
      <button mat-stroked-button color="primary" (click)="exportToExcelIncident()" >Exporter</button>
      <caption>Reporting sur les incidents</caption>
      <tr>
          <!-- <th scope="col">Nombre total d'incidents</th> -->
          <!-- <th scope="col">% BUREAU AVEC TOUS LES AGENTS PRÉSENTE</th> -->
          <!-- <th scope="col">% BUREAU DISPOSANT DE TOUT LE MATERIEL</th> -->
      </tr>
      <tr>
          <th scope="row">Nombre total d'incidents</th>
          <td>{{NI}}</td>
          <!-- <td>4,569</td> -->
      </tr>
      <tr>
        <th scope="row">Manque de matériel électoral essentiel</th>
        <td>{{MMEE}}</td>
        <!-- <td>4,569</td> -->
      </tr>
      <tr>
        <th scope="row">Absence(s) des agents électoraux (moins de 3 agents présents</th>
        <td>{{AAE}}</td>
        <!-- <td>4,569</td> -->
      </tr>
      <tr>
        <th scope="row">Vol de matériel électoral</th>
        <td>{{VME}}</td>
        <!-- <td>4,569</td> -->
      </tr>
      <tr>
        <th scope="row">Incident de violence électorale</th>
        <td>{{IVE}}</td>
        <!-- <td>4,569</td> -->
      </tr>
      <tr>
        <th scope="row">Activité de campagne à l'intérieur du bureau de vote</th>
        <td>{{ACIBV}}</td>
        <!-- <td>4,569</td> -->
      </tr>
      <tr>
        <th scope="row">Achat de conscience</th>
        <td>{{AC}}</td>
        <!-- <td>4,569</td> -->
      </tr>
      <tr>
        <th scope="row">Refus de permettre à un électeur autorisé de voter</th>
        <td>{{RPEEV}}</td>
        <!-- <td>4,569</td> -->
      </tr>
      <tr>
        <th scope="row">Autres</th>
        <td>{{Autre}}</td>
        <!-- <td>4,569</td> -->
      </tr>
    </table>

    <table>
      <button mat-stroked-button color="primary" (click)="exportToExcelTauxBulletinNull()" >Exporter</button>
      <caption>Reporting sur les bulletins nuls</caption>
      <tr>
          <!-- <th scope="col">Nombre total d'incidents</th> -->
          <!-- <th scope="col">% BUREAU AVEC TOUS LES AGENTS PRÉSENTE</th> -->
          <!-- <th scope="col">% BUREAU DISPOSANT DE TOUT LE MATERIEL</th> -->
      </tr>
      <tr>
          <th scope="row">Nombre de bulletins nuls</th>
          <td>{{NbBullNulls}}</td>
          <!-- <td>4,569</td> -->
      </tr>
      <tr>
        <th scope="row">Taux de bulletins nuls</th>
        <td>{{tauxBullNull}} / par 100</td>
        <!-- <td>4,569</td> -->
      </tr>
    </table>

    <!-- <mat-card>

      <div class="mat-elevation-z8">
        <table mat-table [dataSource]="dataSource">
      
          Position Column
          <ng-container matColumnDef="position">
            <th mat-header-cell *matHeaderCellDef> No. </th>
            <td mat-cell *matCellDef="let element; let i=index"> {{ i + 1}} </td>
          </ng-container>
      
          Name Column
          <ng-container matColumnDef="type">
            <th mat-header-cell *matHeaderCellDef> Type </th>
            <td mat-cell *matCellDef="let element"> {{element.typeRapportEntity.libelle}} </td>
          </ng-container>
      
          Weight Column
          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef> Date </th>
            <td mat-cell *matCellDef="let element">{{element.dateRapport | date : "dd MMMM y hh:MM"}} </td>
          </ng-container>

          <ng-container matColumnDef="agent">
            <th mat-header-cell *matHeaderCellDef> Agent </th>
            <td mat-cell *matCellDef="let element"> {{element.affectationagentEntity.agentTerrainEntity.nom}} {{element.affectationagentEntity.agentTerrainEntity.prenom}} </td>
          </ng-container>

          <ng-container matColumnDef="bureauVote">
            <th mat-header-cell *matHeaderCellDef> Bureau Vote </th>
            <td mat-cell *matCellDef="let element"> {{element.affectationagentEntity.bureauvoteEntity.nom}} </td>
          </ng-container>
      
          Symbol Column
          <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef> Actions </th>
            <td mat-cell *matCellDef="let element"> 
              <mat-icon (click)="openDialog(element.idrapport)" style="margin-right: 27px; color: rgb(120, 120, 248);">view_column</mat-icon>
              <mat-icon (click)="openDialog2(element.idrapport)" style="margin-right: 27px; color: rgb(120, 120, 248);">open_in_new</mat-icon>
            </td>
          </ng-container>
      
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      
        <mat-paginator [pageSizeOptions]="[5, 10, 20]"
                       showFirstLastButtons 
                       aria-label="Select page of periodic elements">
        </mat-paginator>
      </div>
  
    </mat-card> -->

    <!-- <div class="p-4 flex space">
      <div class="flex user_info">
      </div>
    </div> -->
  </div>

</div>


</div>

<!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script> -->
<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous"> -->